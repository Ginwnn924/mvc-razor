<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Store Management</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>

<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="/" class="text-2xl font-bold text-blue-600">
                        <i class="fas fa-shopping-bag mr-2"></i>ShopHub
                    </a>
                </div>

                <!-- Search Bar -->
                <div class="flex-1 mx-8">
                    <form class="relative" method="get" action="/Home/Search">
                        <input type="text" name="q" placeholder="Search products..."
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        <button type="submit" class="absolute right-3 top-2.5 text-gray-400 hover:text-gray-600">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>

                <!-- Header Actions -->
                <div class="flex items-center space-x-6">
                    <a href="#" class="text-gray-600 hover:text-blue-600 transition">
                        <i class="fas fa-heart text-xl"></i>
                        <span
                            class="absolute bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center -mt-2 ml-3"
                            data-wishlist-count>0</span>
                    </a>
                    <button id="cartToggle" class="text-gray-600 hover:text-blue-600 transition relative">
                        <i class="fas fa-shopping-cart text-xl"></i>
                        <span
                            class="absolute bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center -mt-2 ml-3"
                            data-cart-count>0</span>
                    </button>
                    <a href="#" class="text-gray-600 hover:text-blue-600 transition">
                        <i class="fas fa-user text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="flex gap-6">
            <!-- Sidebar -->
            <aside class="w-64 flex-shrink-0" id="sidebar"
                style="@(ViewContext.RouteData.Values["action"]?.ToString() == "Details" || ViewContext.RouteData.Values["action"]?.ToString() == "Checkout" ? "display: none;" : "")">
                <div class="bg-white rounded-lg shadow-md p-6 sticky top-24">
                    <!-- Filter by Category -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <i class="fas fa-filter mr-2"></i>Thể loại
                        </h3>
                        <div class="space-y-2">
                            <!-- Option "Tất cả" -->
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="radio" name="category" value="" 
                                       data-filter="category"
                                       @(ViewBag.SelectedCategoryId == null ? "checked" : "") 
                                       class="w-4 h-4 text-blue-600" />
                                <span class="ml-3 text-gray-700">Tất cả</span>
                            </label>
                            
                            <!-- Loop qua categories từ database -->
                            @if (ViewBag.Categories != null)
                            {
                                @foreach (var category in ViewBag.Categories)
                                {
                                    <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                        <input type="radio" name="category" 
                                               value="@category.CategoryId"
                                               data-filter="category"
                                               @(ViewBag.SelectedCategoryId != null && ViewBag.SelectedCategoryId == category.CategoryId ? "checked" : "")
                                               class="w-4 h-4 text-blue-600" />
                                        <span class="ml-3 text-gray-700">@category.CategoryName</span>
                                    </label>
                                }
                            }
                        </div>
                    </div>

                    <hr class="my-6" />

                    <!-- Filter by Price -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <i class="fas fa-dollar-sign mr-2"></i>Mức giá
                        </h3>
                        <div class="space-y-2">
                            @{
                                var minPrice = ViewBag.MinPrice as decimal?;
                                var maxPrice = ViewBag.MaxPrice as decimal?;
                                var priceValue = "";
                                var isCustomPrice = false;
                                
                                // Check if price matches predefined ranges
                                if (minPrice == 0 && maxPrice == 50000) { priceValue = "0-50000"; }
                                else if (minPrice == 50000 && maxPrice == 200000) { priceValue = "50000-200000"; }
                                else if (minPrice == 200000 && maxPrice == 1000000) { priceValue = "200000-1000000"; }
                                else if (minPrice == 1000000 && maxPrice == null) { priceValue = "1000000-"; }
                                else if (minPrice.HasValue || maxPrice.HasValue) { 
                                    priceValue = "custom";
                                    isCustomPrice = true;
                                }
                            }
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="radio" name="price" value="" class="w-4 h-4 text-blue-600" data-filter="price" @(priceValue == "" ? "checked" : "") />
                                <span class="ml-3 text-gray-700">Tất cả</span>
                            </label>
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="radio" name="price" value="0-50000" class="w-4 h-4 text-blue-600" data-filter="price" @(priceValue == "0-50000" ? "checked" : "") />
                                <span class="ml-3 text-gray-700">Dưới 50.000đ</span>
                            </label>
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="radio" name="price" value="50000-200000" class="w-4 h-4 text-blue-600" data-filter="price" @(priceValue == "50000-200000" ? "checked" : "") />
                                <span class="ml-3 text-gray-700">Từ 50.000đ - 200.000đ</span>
                            </label>
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="radio" name="price" value="200000-1000000" class="w-4 h-4 text-blue-600" data-filter="price" @(priceValue == "200000-1000000" ? "checked" : "") />
                                <span class="ml-3 text-gray-700">Từ 200.000đ - 1.000.000đ</span>
                            </label>
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="radio" name="price" value="1000000-" class="w-4 h-4 text-blue-600" data-filter="price" @(priceValue == "1000000-" ? "checked" : "") />
                                <span class="ml-3 text-gray-700">Trên 1.000.000đ</span>
                            </label>
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="radio" name="price" value="custom" id="priceCustomRadio" class="w-4 h-4 text-blue-600" data-filter="price" @(priceValue == "custom" ? "checked" : "") />
                                <span class="ml-3 text-gray-700">Tùy chỉnh</span>
                            </label>
                            
                            <!-- Custom Price Inputs -->
                            <div id="customPriceInputs" class="ml-7 mt-2 @(isCustomPrice ? "" : "hidden")">
                                <div class="flex flex-col gap-2">
                                    <div class="flex gap-2">
                                        <input type="number" id="customMinPrice" placeholder="Từ (đ)" min="0" step="1000" 
                                            value="@(minPrice.HasValue && isCustomPrice ? minPrice.Value.ToString("0") : "")"
                                            class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
                                        <input type="number" id="customMaxPrice" placeholder="Đến (đ)" min="0" step="1000"
                                            value="@(maxPrice.HasValue && isCustomPrice ? maxPrice.Value.ToString("0") : "")"
                                            class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
                                    </div>
                                    <button type="button" id="applyCustomPrice" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition text-sm font-semibold">
                                        Áp dụng
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <hr class="my-6" />

                    <!-- Filter by Rating -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <i class="fas fa-star mr-2"></i>Rating
                        </h3>
                        <div class="space-y-2">
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="w-4 h-4 text-blue-600 rounded" />
                                <span class="ml-3 text-yellow-500">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </span>
                            </label>
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="w-4 h-4 text-blue-600 rounded" />
                                <span class="ml-3 text-yellow-500">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                </span>
                            </label>
                            <label class="flex items-center cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" class="w-4 h-4 text-blue-600 rounded" />
                                <span class="ml-3 text-yellow-500">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                    <i class="far fa-star"></i>
                                </span>
                            </label>
                        </div>
                    </div>

                    <hr class="my-6" />

                    <!-- Clear Filters -->
                    <button
                        class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition font-semibold" data-clear-filters>
                        Clear Filters
                    </button>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="flex-1">
                @RenderBody()
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <!-- About -->
                <div>
                    <h4 class="text-white font-semibold mb-4">About ShopHub</h4>
                    <p class="text-sm text-gray-400">
                        Your one-stop shop for quality products at unbeatable prices. We're committed to providing the
                        best shopping experience.
                    </p>
                </div>

                <!-- Quick Links -->
                <div>
                    <h4 class="text-white font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Home</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Shop</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Contact</a></li>
                    </ul>
                </div>

                <!-- Customer Service -->
                <div>
                    <h4 class="text-white font-semibold mb-4">Customer Service</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="text-gray-400 hover:text-white transition">FAQ</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Shipping Info</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Returns</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Support</a></li>
                    </ul>
                </div>

                <!-- Contact -->
                <div>
                    <h4 class="text-white font-semibold mb-4">Contact Us</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><i class="fas fa-phone mr-2"></i>1-800-SHOPHUB</li>
                        <li><i class="fas fa-envelope mr-2"></i>support@shophub.com</li>
                        <li><i class="fas fa-map-marker-alt mr-2"></i>123 Shop Street, City, State</li>
                    </ul>
                </div>
            </div>

            <hr class="border-gray-700 mb-8" />

            <!-- Social Media & Copyright -->
            <div class="flex justify-between items-center">
                <p class="text-sm text-gray-400">&copy; 2024 ShopHub. All rights reserved.</p>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Cart Overlay -->
    <div id="cartOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300">
    </div>

    <!-- Shopping Cart Sidebar -->
    <div id="cartSidebar"
        class="fixed right-0 top-0 h-full w-96 bg-white shadow-lg z-50 transform translate-x-full transition-transform duration-300 flex flex-col">
        <!-- Cart Header -->
        <div class="bg-white border-b border-gray-200 p-4 flex justify-between items-center">
            <h2 class="text-lg font-bold text-gray-800">
                Giỏ hàng
            </h2>
            <button id="closeCart" class="text-gray-600 hover:text-gray-800 p-1 transition">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>

        <!-- Cart Items Container -->
        <div id="cartItemsContainer" class="flex-1 overflow-y-auto p-4">
            <!-- Cart items will be inserted here -->
            <div id="emptyCartMessage" class="text-center py-12">
                <i class="fas fa-shopping-bag text-5xl text-gray-300 mb-3"></i>
                <p class="text-gray-600 font-semibold">Giỏ hàng trống</p>
                <p class="text-gray-500 text-xs mt-1">Thêm sản phẩm để bắt đầu!</p>
            </div>
        </div>

        <!-- Cart Footer -->
        <div class="border-t border-gray-200 p-4 space-y-4">
            <!-- Promotion Code -->
            <div class="flex gap-2">
                <input type="text" id="promoCode" placeholder="Mã khuyến mãi"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition" />
                <button id="applyPromo"
                    class="bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700 active:bg-gray-800 transition font-semibold">
                    Áp dụng
                </button>
            </div>

            <!-- Cart Summary -->
            <div class="space-y-2 text-sm border-t border-gray-200 pt-4">
                <div class="flex justify-between items-center">
                    <span class="text-gray-600 font-medium">Tổng cộng:</span>
                    <span id="total" class="font-bold text-2xl text-blue-600">0đ</span>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="space-y-3 pt-2">
                <button type="button" id="checkoutBtn"
                    class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 rounded-lg text-base font-bold hover:from-blue-700 hover:to-blue-800 active:from-blue-800 active:to-blue-900 transition shadow-md hover:shadow-lg block text-center disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fas fa-credit-card mr-2"></i>Thanh toán
                </button>
                <button id="continueShopping"
                    class="w-full bg-white border-2 border-blue-600 text-blue-600 py-3 rounded-lg text-base font-bold hover:bg-blue-50 active:bg-blue-100 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Tiếp tục mua sắm
                </button>
            </div>
        </div>
    </div>

    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>